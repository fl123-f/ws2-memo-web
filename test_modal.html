<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>弹窗功能测试</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .test-btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .test-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>弹窗功能测试</h1>
        <p>点击下面的按钮测试不同类型的弹窗：</p>
        
        <div class="test-buttons">
            <button class="test-btn" id="test-alert">测试警告弹窗</button>
            <button class="test-btn" id="test-confirm">测试确认弹窗</button>
            <button class="test-btn" id="test-detail">测试详情弹窗</button>
            <button class="test-btn" id="test-custom">测试自定义弹窗</button>
        </div>
        
        <div id="test-result">
            <h3>测试结果：</h3>
            <p id="result-text">等待测试...</p>
        </div>
        
        <div style="margin-top: 30px;">
            <a href="index.html" style="color: #3498db; text-decoration: none;">← 返回主应用</a>
        </div>
    </div>

    <!-- 弹窗容器（与主应用相同） -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modal-title">弹窗标题</h3>
                <button id="modal-close" class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                弹窗内容
            </div>
            <div class="modal-footer" id="modal-footer">
                <button id="modal-cancel" class="modal-btn modal-btn-secondary">取消</button>
                <button id="modal-confirm" class="modal-btn modal-btn-primary">确认</button>
            </div>
        </div>
    </div>

    <script type="module">
        // 导入弹窗管理器
        import { ModalManager } from './js/modal.js';
        
        // 创建弹窗管理器实例
        const testModal = new ModalManager();
        
        // 获取DOM元素
        const alertBtn = document.getElementById('test-alert');
        const confirmBtn = document.getElementById('test-confirm');
        const detailBtn = document.getElementById('test-detail');
        const customBtn = document.getElementById('test-custom');
        const resultText = document.getElementById('result-text');
        
        // 测试警告弹窗
        alertBtn.addEventListener('click', async () => {
            resultText.textContent = '显示警告弹窗...';
            await testModal.alert('测试警告', '这是一个警告消息弹窗测试！');
            resultText.textContent = '警告弹窗已关闭';
        });
        
        // 测试确认弹窗
        confirmBtn.addEventListener('click', async () => {
            resultText.textContent = '显示确认弹窗...';
            try {
                const confirmed = await testModal.confirm('测试确认', '您确定要执行此操作吗？');
                resultText.textContent = confirmed ? '用户点击了确认' : '用户取消了操作';
            } catch (error) {
                resultText.textContent = '用户取消了操作（通过ESC或点击遮罩）';
            }
        });
        
        // 测试详情弹窗
        detailBtn.addEventListener('click', async () => {
            resultText.textContent = '显示详情弹窗...';
            const testMemo = {
                id: 1,
                title: '测试备忘录标题',
                category: '测试分类',
                date: '2025-12-17 22:00:00',
                content: '这是一个测试备忘录内容。\n包含多行文本。\n\n第三行文本。'
            };
            await testModal.showMemoDetail(testMemo);
            resultText.textContent = '详情弹窗已关闭';
        });
        
        // 测试自定义弹窗
        customBtn.addEventListener('click', async () => {
            resultText.textContent = '显示自定义弹窗...';
            const customContent = `
                <div style="padding: 10px;">
                    <h4>自定义内容</h4>
                    <p>这是一个自定义弹窗内容，可以包含任何HTML。</p>
                    <ul>
                        <li>项目 1</li>
                        <li>项目 2</li>
                        <li>项目 3</li>
                    </ul>
                </div>
            `;
            
            try {
                const result = await testModal.custom('自定义弹窗', customContent, {
                    cancelText: '取消',
                    confirmText: '确定'
                });
                resultText.textContent = '自定义弹窗已确认';
            } catch (error) {
                resultText.textContent = '自定义弹窗已取消';
            }
        });
        
        console.log('弹窗测试页面已加载');
    </script>
</body>
</html>
