<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>モーダル機能テスト</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .test-btn {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .test-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>モーダル機能テスト</h1>
        <p>下のボタンをクリックして、さまざまなタイプのモーダルをテストしてください：</p>
        
        <div class="test-buttons">
            <button class="test-btn" id="test-alert">警告モーダルテスト</button>
            <button class="test-btn" id="test-confirm">確認モーダルテスト</button>
            <button class="test-btn" id="test-detail">詳細モーダルテスト</button>
            <button class="test-btn" id="test-custom">カスタムモーダルテスト</button>
        </div>
        
        <div id="test-result">
            <h3>テスト結果：</h3>
            <p id="result-text">テスト待機中...</p>
        </div>
        
        <div style="margin-top: 30px;">
            <a href="index.html" style="color: #3498db; text-decoration: none;">← メインアプリに戻る</a>
        </div>
    </div>

    <!-- モーダルコンテナ（メインアプリと同じ） -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modal-title">モーダルタイトル</h3>
                <button id="modal-close" class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                モーダル内容
            </div>
            <div class="modal-footer" id="modal-footer">
                <button id="modal-cancel" class="modal-btn modal-btn-secondary">キャンセル</button>
                <button id="modal-confirm" class="modal-btn modal-btn-primary">確認</button>
            </div>
        </div>
    </div>

    <script type="module">
        // モーダルマネージャーをインポート
        import { ModalManager } from './js/modal.js';
        
        // モーダルマネージャーインスタンスを作成
        const testModal = new ModalManager();
        
        // DOM要素を取得
        const alertBtn = document.getElementById('test-alert');
        const confirmBtn = document.getElementById('test-confirm');
        const detailBtn = document.getElementById('test-detail');
        const customBtn = document.getElementById('test-custom');
        const resultText = document.getElementById('result-text');
        
        // 警告モーダルをテスト
        alertBtn.addEventListener('click', async () => {
            resultText.textContent = '警告モーダルを表示中...';
            await testModal.alert('テスト警告', 'これは警告メッセージモーダルのテストです！');
            resultText.textContent = '警告モーダルが閉じられました';
        });
        
        // 確認モーダルをテスト
        confirmBtn.addEventListener('click', async () => {
            resultText.textContent = '確認モーダルを表示中...';
            try {
                const confirmed = await testModal.confirm('テスト確認', 'この操作を実行してもよろしいですか？');
                resultText.textContent = confirmed ? 'ユーザーが確認をクリックしました' : 'ユーザーが操作をキャンセルしました';
            } catch (error) {
                resultText.textContent = 'ユーザーが操作をキャンセルしました（ESCまたはオーバーレイクリック）';
            }
        });
        
        // 詳細モーダルをテスト
        detailBtn.addEventListener('click', async () => {
            resultText.textContent = '詳細モーダルを表示中...';
            const testMemo = {
                id: 1,
                title: 'テストメモタイトル',
                category: 'テストカテゴリ',
                date: '2025-12-17 22:00:00',
                content: 'これはテストメモの内容です。\n複数行のテキストを含みます。\n\n3行目のテキストです。'
            };
            await testModal.showMemoDetail(testMemo);
            resultText.textContent = '詳細モーダルが閉じられました';
        });
        
        // カスタムモーダルをテスト
        customBtn.addEventListener('click', async () => {
            resultText.textContent = 'カスタムモーダルを表示中...';
            const customContent = `
                <div style="padding: 10px;">
                    <h4>カスタムコンテンツ</h4>
                    <p>これはカスタムモーダルコンテンツで、任意のHTMLを含めることができます。</p>
                    <ul>
                        <li>項目 1</li>
                        <li>項目 2</li>
                        <li>項目 3</li>
                    </ul>
                </div>
            `;
            
            try {
                const result = await testModal.custom('カスタムモーダル', customContent, {
                    cancelText: 'キャンセル',
                    confirmText: '確定'
                });
                resultText.textContent = 'カスタムモーダルが確認されました';
            } catch (error) {
                resultText.textContent = 'カスタムモーダルがキャンセルされました';
            }
        });
        
        console.log('モーダルテストページが読み込まれました');
    </script>
</body>
</html>
